<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>인사 정보 등록</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/registPage.css}">

</head>
<body>

<aside class="aside-class">
    <div class="aside-div-class">LYNK</div> <br><br>

    <h6 style="color: white">My</h6>
    <div class="aside-text-class">
        <div class="btn-group">
            <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <span class="arrow">&gt;</span> 최근 사용한 메뉴
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li><a class="dropdown-item" href="#">Menu item 1</a></li>
            </ul>
        </div>

        <div class="btn-group">
            <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <span class="arrow">&gt;</span> 즐겨 찾기
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li><a class="dropdown-item" href="#">Menu item 1</a></li>
            </ul>
        </div>

        <div><br><br>
            <h6 style="color: white">Menu</h6>

            <div class="btn-group">
                <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="arrow">&gt;</span> 홈
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#">Menu item 1</a></li>
                </ul>
            </div><br>

            <div class="btn-group">
                <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="arrow">&gt;</span> 공지사항
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#">Menu item 1</a></li>
                </ul>
            </div><br>

            <div class="menuContainer">
                <ul id="menuList">
                    <li class="humanMenu">
                        <a href="#">
                            <span class="arrow">></span>인사관리
                        </a>
                        <ul class="subMenu">
                            <li><a href="/employee/join" style="text-decoration: none">인사정보</a></li>
                            <li><a href="/employee/regist" style="text-decoration: none">인사등록</a></li>
                            <li><a href="/employee/list" style="text-decoration: none">근태관리</a></li>
                            <li><a href="/employee/list" style="text-decoration: none">일정관리</a></li>
                        </ul>
                    </li>
                </ul>

            </div>
            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    const menuItems = document.querySelectorAll(".humanMenu > a"); // 메뉴 클릭 요소

                    menuItems.forEach((menuItem) => {
                        menuItem.addEventListener("click", (e) => {
                            e.preventDefault(); // 기본 동작 차단
                            const subMenu = menuItem.nextElementSibling; // 하위 메뉴 UL
                            const isOpen = subMenu.style.height !== "0px"; // 현재 상태 확인

                            if (isOpen) {
                                // 닫기
                                subMenu.style.height = "0px";
                            } else {
                                // 기존 열려 있는 하위 메뉴 닫기
                                document.querySelectorAll(".subMenu").forEach((menu) => {
                                    menu.style.height = "0px";
                                });

                                // 선택한 메뉴 열기
                                subMenu.style.height = `${subMenu.scrollHeight}px`; // 콘텐츠 크기만큼 열기
                            }
                        });
                    });
                });
            </script>

            <div class="btn-group">
                <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="arrow">&gt;</span> 전자결재
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#">Menu item 1</a></li>
                </ul>
            </div><br>

            <div class="btn-group">
                <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="arrow">&gt;</span> DB관리
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#">Menu item 1</a></li>
                </ul>
            </div><br>

            <div class="btn-group">
                <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="arrow">&gt;</span> 계약관리
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#">Menu item 1</a></li>
                </ul>
            </div>

        </div>
    </div>

</aside>
<div class="right-container">

    <header class="header-class">January

        <div>
            <button>MON<br>1</button>
        </div>

        <div>
            <button>TUE<br>2</button>
        </div>

        <div>
            <button>WED<br>3</button>
        </div>

    </header>

    <section class="main-content">

        <div class="table-container">
            <h2 class="table-header">인사 등록이 필요한 직원 정보</h2>
            <div class="table-wrapper">
                <table class="styled-table">
                    <thead>
                    <tr>
                        <th>사진</th>
                        <th>사번</th>
                        <th>이름</th>
                        <th>부서</th>
                        <th>직책</th>
                        <th>이메일</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="abc : ${list}" class="clickable-row"
                        th:data-picture="${abc.picture}"
                        th:data-id="${abc.id}"
                        th:data-name="${abc.name}"
                        th:data-department="${abc.departmentDTO.depName}"
                        th:data-position="${abc.humanDTO.position}"
                        th:data-email="${abc.email}">
                        <td th:text="${abc.picture}"></td>
                        <td th:text="${abc.id}"></td>
                        <td th:text="${abc.name}"></td>
                        <td th:text="${abc.departmentDTO.depName}"></td>
                        <td th:text="${abc.humanDTO.position}"></td>
                        <td th:text="${abc.email}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                // 모든 클릭 가능한 행 가져오기
                const rows = document.querySelectorAll(".clickable-row");

                rows.forEach(row => {
                    row.addEventListener("click", () => {
                        // 데이터 추출
                        const picture = row.getAttribute("data-picture");
                        const id = row.getAttribute("data-id");
                        const name = row.getAttribute("data-name");
                        const department = row.getAttribute("data-department");
                        const position = row.getAttribute("data-position");
                        const email = row.getAttribute("data-email");

                        // 폼에 데이터 삽입
                        document.getElementById("formPhoto").textContent = picture || "사진 없음";
                        document.getElementById("formId").value = id || "";
                        document.getElementById("formName").value = name || "";
                        document.getElementById("formDepartment").value = department || "";
                        document.getElementById("formPosition").value = position || "";
                        document.getElementById("formEmail").value = email || "";
                    });
                });
            });

        </script>

        <div class=form-container>
        <form action="/employee/regist" method="post" onsubmit="combineEmail(); return true;">
            <div class="regist-div-class">
                <!-- 상단 제목 -->
                <div class="header">인사 정보 등록</div>
                <button type="button" class="cancle-button">취소</button> <!-- 취소 버튼 -->

                <!-- 사진 및 입력 필드 -->
                <div class="content-wrapper">
                    <!-- 사진 업로드 영역 -->
                    <div class="photo" id="formPhoto">사 진</div> <!-- 사진 받아와서 연결 -->

                    <!-- 입력 필드 -->
                    <div class="field-container">
                        <div class="field-group">
                            <label>사 번</label> <!-- 사번 받아와서 연결 -->
                            <input type="number" name="id" id="formId" placeholder="20241210">
                        </div>

                        <div class="field-group">
                            <label>이 름</label> <!-- 이름 받아와서 연결 -->
                            <input type="text" name="name" id="formName" placeholder="홍길동">
                        </div>


                        <div class="field-group">
                            <label>부 서</label> <!-- 부서 받아와서 연결 -->
                            <input type="text" name="text" id="formDepartment" placeholder="인사팀">
                        </div>

                        <div class="field-group">
                            <label>직 책</label> <!-- 직책 받아와서 연결 -->
                            <input type="text" name="position" id="formPosition" placeholder="사원">
<!--                            <select name="position" id="position">-->
<!--                                <option value="인턴">인턴</option>-->
<!--                                <option value="사원">사원</option>-->
<!--                                <option value="대리">대리</option>-->
<!--                                <option value="과장">과장</option>-->
<!--                                <option value="차장">차장</option>-->
<!--                                <option value="부장">부장</option>-->
<!--                            </select>-->
                        </div>

                        <div class="field-group">
                            <label>이메일</label> <!-- 이메일 받아와서 연결 -->
                            <input type="email" name="email" id="formEmail" placeholder="gyunam@naver.com">
                        </div>

                        <div class="field-group">
                            <label>고용 여부</label>
                            <select name="employeementStatus">
                                <option value="계약직">계약직</option>
                                <option value="정규직">정규직</option>
                            </select>
                        </div>

                        <div class="field-group">
                            <label>주 소</label>
                            <input type="text" name="address" placeholder="서울특별시 강남구 도봉구">
                        </div>

                        <!-- 국적 필드 -->
                        <div class="field-group">
                            <label>국 적</label>
                            <input type="text" name="nation" placeholder="대한민국">
                        </div>

                        <div class="field-group">
                            <label>대표 전화</label>
                            <input type="tel" name="phoneNumber" placeholder="대표 전화">
                        </div>

                        <div class="field-group">
                            <label>입사 일자</label>
                            <input type="date" name="joinDate" placeholder="입사 일자">
                        </div>
                    </div>
                </div>

                <!-- 등록 버튼 -->
                <button type="submit" class="submit-button">등록</button>
            </div>

            <!--            <div class="field-group">-->
            <!--                <label>이메일 :</label>-->
            <!--                <div style="display: flex; gap: 5px">-->
            <!--                <input type="text" name="emailName" placeholder="이메일">-->
            <!--                @-->
            <!--                <select name="emailDomain" id="emailDomain">-->
            <!--                    <option value="naver.com">naver.com</option>-->
            <!--                    <option value="google.com">google.com</option>-->
            <!--                    <option value="daum.net">daum.net</option>-->
            <!--                    <option value="직접 입력">직접 입력</option>-->
            <!--                </select>-->
            <!--                    <input type="text" id="customEmailDomain" name="customEmailDomain" placeholder="도메인 입력" style="display: none; margin-top: 5px;">-->
            <!--                    &lt;!&ndash; Hidden field to send full email &ndash;&gt;-->
            <!--                    <input type="hidden" id="fullEmail" name="email">-->
            <!--                </div>-->
        </form>
        </div>
<!-- 모달 구조 -->
<div th:if="${successMessage}" id="successMessage" th:text="${successMessage}" style="display: none;"></div>
<div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="myModalLabel">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">알림</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modalMessage">
                <!-- 메시지가 동적으로 추가됩니다 -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
            </div>
        </div>
    </div>
</div>

<!--<script>-->
<!--    // 이메일 도메인 선택 시 "직접 입력" 활성화-->
<!--    document.getElementById('emailDomain').addEventListener('change', function () {-->
<!--        const customEmailDomain = document.getElementById('customEmailDomain');-->
<!--        if (this.value === "직접 입력") {-->
<!--            customEmailDomain.style.display = "inline-block";-->
<!--            customEmailDomain.focus();-->
<!--        } else {-->
<!--            customEmailDomain.style.display = "none";-->
<!--            customEmailDomain.value = "";-->
<!--        }-->
<!--    });-->
<!--    function combineEmail() {-->
<!--        const emailName = document.getElementById('emailName').value;-->
<!--        const emailDomain = document.getElementById('emailDomain').value;-->
<!--        const customDomain = document.getElementById('customEmailDomain').value;-->

<!--        // 도메인이 "직접 입력"일 경우 커스텀 도메인 사용-->
<!--        const fullEmail = emailName + "@" + (emailDomain === "직접 입력" ? customDomain : emailDomain);-->

<!--        // hidden input에 저장-->
<!--        document.getElementById('fullEmail').value = fullEmail;-->
<!--        console.log("전체 이메일:", fullEmail);-->
<!--    }-->
<!--</script>-->

<script>
    // document.addEventListener('DOMContentLoaded', () => {
    //     // 서버에서 전달받은 successMessage를 가져옴
    //     const successMessage = document.getElementById('successMessage').textContent.trim();
    //
    //     if (successMessage) {
    //         // 모달 메시지에 설정
    //         const modalMessage = document.getElementById('modalMessage');
    //         modalMessage.textContent = successMessage;
    //
    //         // Bootstrap 모달 표시
    //         const myModal = new bootstrap.Modal(document.getElementById('myModal'));
    //         myModal.show();
    //     }
    // });

    const successMessageElement = document.getElementById('successMessage');
    if (successMessageElement) {
        const successMessage = successMessageElement.textContent.trim();
        if (successMessage) {
            const modalMessage = document.getElementById('modalMessage');
            modalMessage.textContent = successMessage;
            const myModal = new bootstrap.Modal(document.getElementById('myModal'));
            myModal.show();
        }
    }
</script>

    </section>

    <footer class="footer-class"></footer>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>